#!/bin/bash

# Check if inside a git repository
if [[ $(git rev-parse --is-inside-work-tree 2>/dev/null) != "true" ]]; then
	echo "Not in a git repository. Skipping dependency check."
	exit 0
fi

# Check if there are any commits yet
if [[ $(git rev-parse --verify HEAD 2>/dev/null) == "" ]]; then
	echo "No commits yet. Skipping dependency check."
	exit 0
fi

# Check for changes in dependency files
if git diff-tree -r --name-only HEAD@{1} HEAD 2>/dev/null | grep -Eq '(package\.json|package-lock\.json)'; then
	echo "❗ Project dependencies have changed."
	echo "❗ Run 'npm ci' (recommended) or 'npm install' to update."
else
	echo "✅ No dependency changes detected."
fi
